@page
<h1>User Information</h1>
<div id="profile">Loading…</div>

<script>
    async function loadProfile() {
        const raw = localStorage.getItem('token');
        if (!raw) { location.href = '/Auth/Login'; return; }

        const res = await fetch('/api/user/me', {
            headers: { Authorization: 'Bearer ' + raw }   // ← додаємо тут
        });

        if (res.status === 401) {
            //localStorage.removeItem('token');
            //location.href = '/Auth/Login';
            console.error('DEBUG‑401', await res.text());   // ← додамо лог
            return;
        }
        if (!res.ok) { document.getElementById('profile').textContent = 'Error ' + res.status; return; }

        const u = await res.json();
        document.getElementById('profile').innerHTML = `
        <p><b>ID:</b> ${u.id}</p>
        <p><b>Name:</b> ${u.name}</p>
        <p><b>Email:</b> ${u.email}</p>`;
    }
    loadProfile();
</script>
